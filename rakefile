require_relative 'lib/simulator'
require_relative 'lib/bin_available'

desc "Run the unit tests"
task :test do
  
  name    = ENV['NAME']    || 'iPhone'
  version = ENV['VERSION'] || '9.0'
  
  sh "set -o pipefail && xcodebuild -scheme Expectation \
  -target Expectation \
  -destination id=#{Simulator.random(match: name, version: version.to_f).udid} \
  -sdk iphonesimulator \
  test | bundle exec xcpretty"
  
end

desc "Install dependencies"
task :install do
  
  sh "bundle install"
  sh "brew install swiftlint" unless bin_available? "swiftlint"
  
end
